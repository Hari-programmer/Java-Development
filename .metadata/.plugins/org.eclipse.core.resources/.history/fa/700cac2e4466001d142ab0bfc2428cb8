import java.io.BufferedReader;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class text {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		String Path = "C:\\Users\\Hari\\Downloads\\samplerows (1).csv";
		AddColumn(Path,",",21);

	}
	
public static String AddColumn(String path,String delimiter,int colPos) {
		
	String[] newclo ;
	String line1 = "";  
	String splitBy = ",";
	String[] cols = null;
	try   
	{  
	//parsing a CSV file into BufferedReader class constructor  
	BufferedReader br = new BufferedReader(new FileReader(path));  
	while ((line1 = br.readLine()) != null)   //returns a Boolean value  
	{  
	 cols = line1.split(splitBy);    // use comma as separator  
	System.out.println("Coulmn 0= " + cols[0] + " , Column 3=" + cols[3]+ " , Column 13=" + cols[13]+ " , Column 14=" + cols[14]);  
	
     
	} 
	
	} 
	catch (IOException e)   
	{  
	e.printStackTrace();  
	}  
	System.out.println("");
	
	
		try {
			
			List<String> data = Files.readAllLines(Paths.get(path));
			
			PrintWriter pw = new PrintWriter(path);
			
			FileWriter fw = new FileWriter(path,true);
			pw =new PrintWriter(fw);
			
			for(int i=0; i<data.size(); i++) {
				String[] line = data.get(i).split(delimiter);
				List<String> record = new ArrayList<String>(Arrays.asList(line));
				record.add(colPos, newclo[i]);
				pw.println(String.join(delimiter, record));
			}
			
			pw.close();
			System.out.println("Column Added.");
			
		} catch (Exception e) {	
		}
		return splitBy;

}
}
